Інструкція з оновлення проєкту для Release Engineer/DevOps
Цей документ описує покрокові рекомендації для Release Engineer / DevOps фахівця щодо оновлення веб-проєкту, створеного з використанням Laravel, Zoho CRM API, ngrok, PDF-генерації (DomPDF) та Bootstrap.
1. Підготовка до оновлення
   1.1. Перевірити поточну версію застосунку та заплановану версію оновлення.
   1.2. Ознайомитися з останніми змінами в репозиторії Git (гілка release/staging).
   1.3. Переконатися, що середовище виконання (PHP, Composer, Laravel, Node.js) відповідає вимогам проєкту.
2. Створення резервних копій
   2.1 Створення резервної копії
   SQLite зберігає базу в одному .sqlite файлі. Створити резервну копію дуже просто:
   bash
   КопироватьРедактировать
   cp database/database.sqlite database/database_backup_$(date +%F).sqlite
   2.2 Перевірка сумісності
   • Переконайтесь, що нові зміни не вимагають іншої структури таблиць або даних, які відсутні в наявній базі.
   • Проглянь database/migrations на наявність нових файлів.
   • Перевір, що не змінено назви таблиць або важливі поля, інакше — підготуй ручні SQL-запити для оновлення.
   2.3 Планування часу простою
   Для SQLite це, зазвичай, не обов’язково, але:
   • Якщо віджет активно використовується, узгодьте невелике вікно для оновлення (напр., вночі).

2. Процес оновлення (для SQLite)
   2.1 Зупинка служб (опційно)
   • Якщо проєкт розгорнуто на сервері, зупини вебсервер (наприклад, якщо це Laravel + Apache):
   sudo systemctl stop apache2
   або, якщо використовуєш Laravel з php artisan serve:
   CTRL+C
   2.2 Розгортання нового коду
   git pull origin main
   composer install --no-dev --optimize-autoloader
   2.3 Міграція БД
   Якщо є нові міграції:
   php artisan migrate
   Увага: якщо потрібно протестувати їх — зроби спочатку копію бази (див. 2.1).
   2.4 Оновлення конфігурацій

php artisan config:cache
php artisan route:cache
php artisan view:cache

3. Перевірка сумісності
   3.1 Перезапусти сервер
   php artisan serve
   Або:
   sudo systemctl start apache2
   3.2 Перевірка логів
   tail -f storage/logs/laravel.log
   3.1. Ознайомитися з changelog нової версії пакунків у composer.json та package.json.
   3.2. Переконатися, що всі залежності підтримують вашу версію Laravel.
4. Планування часу простою (якщо потрібно)
   4.1. Якщо оновлення вимагає простою — узгодити з командою або клієнтом вікно оновлення.
   4.2. Розмістити повідомлення на сторінці сайту (наприклад, maintenance mode).
5. Процес оновлення
   5.1. Зупинка потрібних служб
   sudo systemctl stop nginx
   sudo systemctl stop php8.2-fpm
   5.2. Розгортання нового коду
   5.2.1. Завантажити останню версію коду з GitLab:
   git pull origin release
   5.2.2. Встановити залежності:
   composer install
   npm install && npm run build
   5.3. Міграція даних (якщо потрібно)
   php artisan migrate
   5.4. Оновлення конфігурацій
   5.4.1. Оновити .env, якщо змінилися змінні середовища.
   5.4.2. Очистити та закешувати конфіги:
   php artisan config:cache
   php artisan route:cache
6. Перевірка після оновлення
   6.1. Перевірити, що застосунок успішно запускається:
   sudo systemctl start php8.2-fpm
   sudo systemctl start nginx
   6.2. Перевірити лог-файли Laravel:
   tail -f storage/logs/laravel.log
